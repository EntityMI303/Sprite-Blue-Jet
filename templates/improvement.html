<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Improvement Guide</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="{{ url_for('static', filename='script.js') }}"></script>
</head>

<body>

    <header class="hero">
        <h1>ðŸ“Š Improvement Guide</h1>
        <p>Recommendations based on your submitted sales data</p>
    </header>

    <div class="sales-container">
        {% if data %}
        <h2>Submitted Sales Data</h2>
        <ul>
            <li><strong>Product Type:</strong> {{ data.product_type }}</li>
            <li><strong>Product:</strong> {{ data.product }}</li>
            <li><strong>Price ($):</strong> {{ data.price }}</li>
            {% if data.product_type == "old" %}
            <li><strong>Previous Annual Sales ($):</strong> {{ data.previous_annual_sales }}</li>
            <li><strong>Total Previous Sales ($):</strong> {{ data.previous_sales }}</li>
            <li><strong>Years of Previous Sales:</strong> {{ data.previous_sales_years }}</li>
            {% else %}
            <li><strong>Projected Volume (units):</strong> {{ data.volume }}</li>
            {% endif %}
            <li><strong>Marketing Budget ($):</strong> {{ data.marketing_budget }}</li>
            <li><strong>Marketing Timeframe:</strong> {{ data.marketing_timeframe }}</li>
            <li><strong>Product Category:</strong> {{ data.product_category or "N/A" }}</li>
            <li><strong>Season:</strong> {{ data.season }}</li>
            <li><strong>Years to be predicted:</strong> {{ data.year }}</li>
            <li><strong>Months to be predicted:</strong> {{ data.month }}</li>
        </ul>

        <h2>Improvement Suggestions</h2>
        <p>
            {% if data.product_type == "new" %}
            Since this is a new product, focus on building awareness and scaling volume.
            Consider introductory pricing strategies and targeted marketing campaigns based on the product category.
            Leverage seasonal boosts during {{ data.season }} for maximum impact.
            {% else %}
            With existing sales history, analyze trends over {{ data.previous_sales_years }} years.
            If sales are declining, adjust pricing or increase marketing investments.
            Leverage seasonal boosts based on the product category to optimize sales.
            {% endif %}
        </p>

        <!-- Improvement comparison chart -->
        <div class="chart-container" style="height: 400px;">
            <canvas id="improvementChart"
                data-previous="{{ data.previous_annual_sales if data.product_type == 'old' else (data.volume | float * data.price | float) }}"
                data-predicted="{{ (data.volume | float * data.price | float) if data.product_type == 'new' else data.previous_annual_sales }}"
                data-marketing="{{ data.marketing_budget }}" data-timeframe="{{ data.marketing_timeframe }}"
                data-category="{{ data.product_category or '' }}" data-season="{{ data.season }}">
            </canvas>
        </div>

        <div class="chart-controls" style="margin-top: 15px;">
            <label><input type="checkbox" id="togglePredicted" checked> Show Predicted Sales</label>
            <label><input type="checkbox" id="toggleMarketing" checked> Apply Marketing Budget</label>
            <button id="downloadCSV">Download CSV</button>
        </div>

        <div style="margin-top: 20px;">
            <a href="{{ url_for('home') }}"><button>Back to Home</button></a>
            <a href="{{ url_for('download_sales') }}"><button>Download Data</button></a>
        </div>

        {% else %}
        <p>No sales data submitted yet.</p>
        {% endif %}
    </div>

    <footer>
        &copy; 2025 Sprite Blue Jet. Built for FBLA Coding & Programming.
    </footer>

</body>

</html>